version: '3.8'

services:
  # Spring Boot 后端服务
  backend:
    build:
      context: .
      dockerfile: Dockerfile.backend
    container_name: ai-agent-backend
    environment:
      SPRING_PROFILES_ACTIVE: prod
    network_mode: "host"
    volumes:
      - ./agent-memory:/app/agent-memory
      - ./src/main/resources/document:/app/document
      - ./downloads:/app/downloads
    restart: unless-stopped

  # Vue.js 前端服务
  frontend:
    build:
      context: ./ai-agent-frontend
      dockerfile: ../Dockerfile.frontend
    container_name: ai-agent-frontend
    ports:
      - "80:80"
    restart: unless-stopped
